# Conventions - Brick UI Component System

## Общие принципы
1. **KISS во всём:** Максимально простые решения, никакого оверинжиниринга
2. **Иммутабельность:** Все компоненты Brick должны быть readonly
3. **Типобезопасность:** Используем strict_types=1 и типизацию PHP 8.2+
4. **Предсказуемость:** Одинаковые входные данные = одинаковый HTML вывод

## Структура кода
5. **Следовать структуре проекта:** Как описано в [@concept.md](#3-структура-проекта)
6. **Одна ответственность:** Каждый класс/трейт решает одну задачу
7. **Минимальные зависимости:** Только необходимые зависимости, избегать circular dependencies

## Компоненты (Brick/Clay)
8. **Brick для UI:** Все UI компоненты наследуют от Brick
9. **Clay только для особых случаев:** Только когда требуется мутабельность
10. **Публичные свойства:** Использовать public readonly свойства для данных компонента
11. **Конструктор с типизацией:** Все параметры должны быть строго типизированы
12. **Вызов parent::__construct():** Обязательно в конструкторе компонента

## Трейты
13. **Один трейт = одна фича:** Каждый трейт добавляет одну функциональность
14. **Использовать exists() проверки:** В трейтах проверять class_uses() перед применением
15. **Не дублировать функциональность:** Использовать существующие трейты, не создавать аналоги

## Шаблоны (template.php)
16. **Без логики:** Шаблоны только для отображения, минимум PHP кода
17. **Использовать $this->e():** Всегда экранировать вывод через метод e()
18. **Безопасные хелперы:** Использовать методы из WithHelpers для сложных операций

## Обработка ошибок
19. **Понятные исключения:** Всегда выбрасывать исключения с информативными сообщениями
20. **Типизированные исключения:** Использовать соответствующие классы исключений
21. **Не молчать:** Не игнорировать ошибки, всегда обрабатывать или пробрасывать выше

## Тестирование
22. **100% покрытие:** Стремиться к полному покрытию тестами
23. **Тестировать публичный API:** Фокус на тестировании публичных методов
24. **Именованные тесты:** Использовать descriptive имена для тестовых методов

## Code Quality
25. **PSR-12:** Следовать стандарту кодирования PSR-12
26. **PHPStan level MAX:** Код должен проходить максимальный уровень статического анализа
27. **Документировать публичный API:** PHPDoc для всех публичных методов и классов
28. **Английские имена:** Имена классов, методов, переменных на английском

## Производительность
29. **Кэширование через WithCache:** Использовать трейт WithCache для кэширования рендеринга
30. **Минимизация IO:** Кэшировать файловые операции в BrickManager
31. **Оптимизация ассетов:** Использовать минификацию в AssetRenderer

## Безопасность
32. **Экранирование по умолчанию:** Всегда экранировать HTML специальные символы
33. **Защита от XSS:** Фильтровать опасные атрибуты (on*, javascript:)
34. **Валидация входных данных:** Валидировать данные в конструкторах компонентов

## Конфигурация
35. **Конфигурация через код:** Только через методы BrickManager, без конфиг-файлов
36. **Разумные умолчания:** Библиотека должна работать без дополнительной конфигурации

## Документация
37. **Живые примеры:** Примеры кода должны быть работоспособными
38. **Код как документация:** Чистый, самодокументируемый код
39. **Обновлять README:** Все изменения в API отражать в документации

## Основное правило
40. **Если сомневаешься - смотри @concept.md:** Все архитектурные решения уже описаны в основном документе